<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ko" lang="ko">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="copyright" content="Copyright(c) White Lab Inc. All Rights Reserved." />
    <title>OnStory Admin</title>
    <link rel="stylesheet" type="text/css" href="/Admin/PC/css/suio.css" media="screen" charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/Admin/PC/css/layout.css" media="screen" charset="utf-8">
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>		

	<script language="javascript" src="/Common/js/jquery.xml2json.js"></script>
	<script language="javascript" src="/Common/js/common.js?v1"></script>
	<script language="javascript" src="/Admin/adm_cmn/js/admin_common.js?v2"></script>
</head>
<body>

<div style="width:1020px">   
    <form id="frm_default" name="frm_default" method="post">
	<input type="hidden" id="acc_idx" name="acc_idx" value="" /> 
    <!-- 폼 내용 -->
	<div class="section" id="QA_profile1">
        <div>&nbsp;</div>
        <div>&nbsp;</div>
        <div class="optionArea">
            <div class="mOption" style="display: block;">
                <table border="1" summary="">
                <caption>회원정보 조회</caption>
                <colgroup>
                    <col style="width:154px;*width:135px;" />
                    <col style="width:auto;" />
                    <col style="width:154px;*width:135px;" />
                    <col style="width:auto;" />
                </colgroup>
                <tbody>
                    <tr>
                        <th scope="row">아이디 <strong class="icoRequired">필수</strong></th>
                        <td>
                            <input type="text" id="adm_id" name="adm_id" value="" class="fText" style="width:200px;" />
                        </td>
                        <th scope="row">이름 <strong class="icoRequired">필수</strong></th>
                        <td>
                            <input type="text" id="admName" name="admName" value="" class="fText" style="width:200px;" />
                        </td>                        
                    </tr>
                    <tr>
                        <th scope="row">비밀번호 <strong class="icoRequired">필수</strong></th>
                        <td>
                            <input type="password" id="passwd" name="passwd" value="" class="fText" style="width:200px;" />
                        </td>
                        <th scope="row">사용유무</th>
                        <td>
                            <input id="using_Y" type="radio" name="using_yn" value="Y" checked class="fChk" /> 사용</label> 
                            <input id="using_N" type="radio" name="using_yn" value="N" class="fChk" /> 중지</label> 
                        </td>                        
                    </tr>                                        
                    <tr>
                        <th scope="row">메모</th>
                        <td colspan="3">
                        	<input type="text" id="memo" name="memo" value="" class="fText" style="width:600px;" />
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
		<!-- 버튼 -->
		<div class="mButton gCenter">
		    <a id="btn_Insert" class="btnSubmit"><span>등록</span></a>
		    <a id="btn_Update" class="btnSubmit"><span>수정</span></a>
		    <a id="btn_Delete" class="btnSubmit"><span>삭제</span></a>
		    <a id="btn_List" class="btnSearch reset"><span>목록</span></a>
		    <a id="btn_Reset" class="btnSearch reset"><span>초기화</span></a>
		</div>
        <!-- // 버튼 -->
    </div>
    <!-- // 폼 내용 -->
	<!-- 처리중 -->
	<div class="mLoading typeStatic">
	    <p>처리중입니다. 잠시만 기다려 주세요.</p>
	    <img src="http://img.echosting.cafe24.com/suio/ico_loading.gif" alt="" />
	</div>
	<!-- // 처리중 -->

    <!--###############  페이지 Block ###############-->
	<!-- 도움말 영역 -->

	<!-- // 도움말 영역 -->
    </form>
</div>        

<script>    
//************** ajax 에러 처리  ************************
$(document).ajaxError(function (event, xhr, options, exc) {
    if (xhr.status != 200){
        var msg = "";
        msg = msg + "# options.data : " + options.data + " , ";
        msg = msg + "# options.url : " + options.url + " , ";
        msg = msg + "# options.contentType : " + options.contextType + " , ";
        msg = msg + "# xhr.status : " + xhr.status + " , ";
        msg = msg + "# xhr.statusText : " + xhr.statusText + " , ";
        msg = msg + "# xhr.responseText : " + xhr.responseText + " , ";
        Msg("ALERT", "ajaxError", msg, "");
    }
});

</script>
<script src="/Common/js/_w-meta-1.4.0.js?aaaaa"></script>
<script src="/Common/js/_w-meta-1.4.0.test.js"></script>

<script>
// http://rtwgs4.cafe24.com/admin/pc/mod/sto/Account_Frm.asp?mode=EDIT&acc_idx=6
// http://rtwgs4.cafe24.com/admin/pc/mod/sto/Account_Frm.asp?mode=CREATE
// #######################################################################################################
// 특정 기능을 수행하는 화면을 Frm, Edit 기능을 기준으로 
var util                    = _W.Common.Util;
var IBindModelForm          = _W.Interface.IBindModelForm;

function FormDI() {
    IBindModelForm.call(this);

    var params = ParamGet2JSON(location.href);      //admin_common.js

    this.attr["mode"] = params.mode;
    
    this.cbFail = function(p_value, p_msg, p_code) {
        Msg("ALERT", "실패", p_msg);
        console.log("실패 :: Value=\"%s\", Code=\"%s\", Message=\"%s\" ", p_value, p_code, p_msg);
    };
    this.cbError = function(p_msg, p_status) {
        Msg("ALERT", "오류", p_msg);
        console.log("오류 :: Status=\"%s\" , Message=\"%s\" ", p_status, p_msg);
    };
    // this.onExecute = function(p_bindCommand) {       // 실행시 이벤트 등록
    //     console.log("onExecute 이벤트. ");
    // };
    // this.onExecuted = function(p_bindCommand) {      // 실행끝 이벤트 등록
    //     console.log("onExecuted 이벤트.. ");
    // };
}
util.inherits(FormDI, IBindModelForm);
// 정적 메소드
FormDI.deleteValid = function() {
        return confirm("삭제 하시겠습니까 ?");
};
FormDI.updateValid = function() {
        return confirm("수정 하시겠습니까 ?");
};
FormDI.createEnd = function() {
        return alert("정상 등록되었습니다.");
};
FormDI.createMode = function() {
        $("#btn_Update").hide();
        $("#btn_Delete").hide();
        $("#btn_Insert").show();
        $("#btn_Reset").show();
};
FormDI.editMode = function() {
        $("#adm_id").attr("readonly", "");
        $("#btn_Insert").hide();
        $("#btn_Update").show();
        $("#btn_Delete").show();
        $("#btn_Reset").hide();
};
// 오버라이딩
FormDI.prototype.cbRegister = function() {
    console.log("cbRegister : 이벤트 등록 및  콜백 설정 ");

    var _this = this;

    this.delete.cbValid = FormDI.deleteValid;
    this.update.cbValid = FormDI.updateValid;
    this.create.cbEnd   = FormDI.createEnd;

    $("#btn_Update").click(function () {
        _this.update.execute();
    });
    $("#btn_Insert").click(function () {
        _this.create.execute();
    });
    $("#btn_Delete").click(function () {
        _this.delete.execute();
    });
    $("#btn_List").click(function () {
        location.href = _this.first.items["listURL"].value;
    });
    $("#btn_Reset").click(function () {
        Main.Form.reset();
    });
};
FormDI.prototype.cbCheck = function() {   // 2.검사
    console.log("cbCheck : 화면 유효성 검사 ");

    if (typeof this.attr.mode === "undefined" || this.attr.mode === "") {
        Msg("ALERT", "접근경로", "잘못된 접근경로입니다.(cmd)", "A");
        return false;
    }
    if (!(this.attr.mode === "CREATE" || this.attr.mode == "EDIT")) {
        Msg("ALERT", "접근경로", "잘못된 접근경로입니다.(INSERT/UPDATE)", "A");
        return false;
    }
    return true;
};
FormDI.prototype.cbReady = function() {
    console.log("cbReady : 준비완료 ");
    
    if (this.attr.mode === "CREATE") {
        FormDI.createMode();
    } else if (this.attr.mode === "EDIT") {
        FormDI.editMode();
    }    
};
</script>
<script>
// #######################################################################################################
// 특정 비즈니스 로직을 담당하는 기능 (Account_Frm)
var util                    = _W.Common.Util;
var FormDI                  = FormDI;

function FormAccountDI() {
    FormDI.call(this);

    this.attr["cmd"] = "";
    this.attr["doctype"] =  "JSON";
    this.attr["listURL"] = "Account_Lst.asp";
    
    // 업무관점
    this.attr["acc_idx"] = {caption: "일련번호", value: ""};
    this.attr["sto_id"] = "S00001";
    this.attr["adm_id"] = {
        caption: "관리자ID",
        getter: function() { return $("#adm_id").val(); },
        setter: function(val) { $("#adm_id").val(val); }
    };
    this.attr["passwd"] = {
        caption: "비밀번호", 
        getter: function() { return $("#passwd").val(); },
        setter: function(val) { $("#passwd").val(val); }
    };
    this.attr["admName"] = {
        caption: "관리자명", 
        getter: function() { return $("#admName").val(); },
        setter: function(val) { $("#admName").val(val); }
    };
    this.attr["use_yn"] = {
        caption: "사용유무", 
        getter: function() { return $("input[type='radio'][name=using_yn]:checked").val(); },
        setter: function(val) { 
            if (val === "Y" ) $("#using_Y").val(val); $("#using_Y").attr("checked", "checked");
            if (val === "N" ) $("#using_Y").val(val); $("#using_N").attr("checked", "checked");
        }
    };
}
util.inherits(FormAccountDI, FormDI);
// 데코레이션
FormAccountDI.prototype.cbRegister = function() {
    FormDI.prototype.cbRegister.call(this);
};
FormAccountDI.prototype.cbCheck = function() {
    return FormDI.prototype.cbCheck.call(this);
};
FormAccountDI.prototype.cbReady = function() {
    FormDI.prototype.cbReady.call(this);

    if (this.attr.mode === "EDIT")  this.read.execute();
};
</script>
<script>
// #######################################################################################################
// 모델(SP) 기능에 맞는  설정  (Account_SP_CRUDL)
//--------------------------------------------------------------
var BindModelFormAjax       = _W.Meta.Bind.BindModelFormAjax;
/*
    var di = new FormAccountDI(); 
    var e = new BindModelFormAjax(di, true);
*/
var e = new BindModelFormAjax(new FormAccountDI(), true);
e.baseUrl = "/admin/adm_mod/sto/Account.C.asp";                      
// e.baseAjaxSetup.type = "POST";

e.read.setItem(["cmd", "doctype", "acc_idx"], ["valid", "bind"]);
e.read.setItem(["adm_id", "admName", "use_yn", "passwd"], "output");
e.read.outputOption = 3;
e.read.onExecute = function() {
    var params = ParamGet2JSON(location.href);      //admin_common.js
    
    e.first.items["acc_idx"].value = params.acc_idx;     // Biz
    e.first.items["cmd"].value = "READ";
};

e.update.setItem(["acc_idx", "adm_id" ], "valid");
e.update.setItem(["cmd", "doctype", "acc_idx", "admName", "use_yn", "passwd"], "bind");
e.update.onExecute = function() {
    e.first.items["cmd"].value = "UPDATE";
};

e.create.setItem(["cmd", "doctype", "sto_id", "adm_id", "admName", "use_yn", "passwd"], ["valid", "bind"]);
e.create.onExecute = function() {
    e.first.items["cmd"].value = "CREATE";
};

e.delete.setItem(["cmd", "doctype", "acc_idx"], ["valid", "bind"]);
e.delete.onExecute = function() {
    e.first.items["cmd"].value = "DELETE";
};

//--------------------------------------------------------------
// 디버깅 용도
e.read.cbBind = function(setup) {
    console.log("call cbBind");
};
e.update.cbBind = function(setup) {
    console.log("call cbBind");
};
e.create.cbBind = function(setup) {
    console.log("call cbBind");
};

$(document).ready(function () {
    e.init();
});

</script>
</body>